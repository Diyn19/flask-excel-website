<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}PMQ4 系統{% endblock %}</title>

    <!-- 共用 CSS（從你給的樣式抽出） -->
    <style>
        body { font-family: Arial, sans-serif; padding: 40px; background-color: #f7f7f7; }
        h1 { text-align: center; color: #333; }
        form, .buttons { text-align: center; margin-bottom: 20px; }
        input[type="text"], select {
            padding: 10px;
            width: 160px;
            border-radius: 5px;
            border: 1px solid #ccc;
            margin: 5px;
        }
        button {
            padding: 10px 15px;
            font-size: 20px;
            margin: 5px;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button.button-1 { background-color: #20B2AA; }
        button.button-2 { background-color: #FFA500; }
        button.button-3 { background-color: #000000; }
        .button-row { display: flex; flex-wrap: wrap; justify-content: flex-start; gap: 10px; }
        .button a, .button-1 a { text-decoration: none; }

        .table-container {
            overflow-y: auto;
            max-height: 600px;
            border: 1px solid #ccc;
        }
        .table-container-NO {
            overflow-y: visible;
            max-height: none;
            border: 1px solid #ccc;
        }
        table { width: 100%; border-collapse: collapse; background-color: white; table-layout: fixed; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: center; word-wrap: break-word; }
        th {
            background-color: #007BFF;
            color: white;
            position: sticky;
            top: 0;
            z-index: 2;
        }
        tr:hover { background-color: #f1f1f1; }
        .highlight-row td { color: red; font-weight: bold; border-top: 2px solid black; }
        .status-pm { background-color: red; color: white; }
        .status-replaced { color: green; }
        .status-not-replaced { color: red; }
        .status-repair { color: black; font-weight: bold; background-color: #d8ecff; }

        #backToTop {
            position: fixed;
            bottom: 230px;
            right: 30px;
            z-index: 1000;
            display: none;
            padding: 10px 15px;
            font-size: 16px;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        #backToTop:hover { background-color: #0056b3; }

        .version-info { text-align: center; color: gray; font-size: 14px; margin-top: -25px; margin-bottom: 20px; }

        /* 特殊欄位背景色標記（time page 使用） */
        .blue-bg { background-color: lightblue; }
        .orange-bg { background-color: orange; }
        .green-bg { background-color: lightgreen; }

        /* dataframe 樣式 */
        .dataframe { width: 100% !important; border-collapse: collapse; }
        .dataframe th, .dataframe td { border: 1px solid #ccc; padding: 10px; text-align: center; word-break: break-word; }
        .dataframe th { background-color: #007BFF; color: white; position: sticky; top: 0; z-index: 1; }
    </style>

    {% block extra_head %}{% endblock %}
</head>
<body>

    <!-- 動態標題區（子頁會覆蓋） -->
    <h1>{% block header_title %}PMQ4 系統{% endblock %}</h1>

    <!-- 版本資訊 -->
    {% if version %}
        <div class="version-info">版本：{{ version }}</div>
    {% endif %}

    <!-- 搜尋表單（可被子模板覆寫裡面的 search_fields） -->
    <form method="get">
        {% block search_fields %}
            <!-- Default: 全站關鍵字搜尋（子頁例如 report/time 可以覆寫） -->
            <input type="text" name="keyword" placeholder="請輸入關鍵字查詢" value="{{ keyword }}">
            <button type="submit">搜尋</button>
        {% endblock %}
    </form>

    <!-- 共用按鈕列 -->
    <div class="button-row">
        <div class="button">
            <a href="/吳宗鴻"><button type="button">吳宗鴻</button></a>
            <a href="/湯家瑋"><button type="button">湯家瑋</button></a>
            <a href="/狄澤洋"><button type="button">狄澤洋</button></a>
        </div>

        <div class="button-1">
            <a href="/report"><button class="button-1" type="button">報修查詢</button></a>
            <a href="https://bot.toshibatec.com.tw/hl0800/showjob31.php" target="_blank" rel="noopener noreferrer">
                <button class="button-1" type="button">報修刊版</button></a>
            <a href="https://imainte.toshibatec.com.tw/i_mainte_center2/login.cfm?CFID=258322&CFTOKEN=f58548bc0ee07d0d-A0165FB1-FFC4-BBD8-DC3EBB80DDEA857B" target="_blank" rel="noopener noreferrer">
                <button class="button-2" type="button">iMainte</button></a>
            <a href="http://eip.toshibatec.com.tw/Main.aspx" target="_blank" rel="noopener noreferrer">
                <button class="button-2" type="button">EIP</button></a>
            <a href="/time"><button class="button-1" type="button">出勤時間統計</button></a>
            <a href="/calendar"><button class="button-2" type="button">排程表</button></a>
            <a href="/mfp_parts"><button class="button-1" type="button">MFP_零件表</button></a>
            <a href="https://count-7mdt.onrender.com" target="_blank" rel="noopener noreferrer"><button class="button-1" type="button">客戶TG系統</button></a>

            {% if personal_page or report_page or time_page or calendar_page or mfp_parts %}
                <a href="/"><button class="button-3" type="button">回首頁</button></a>
            {% endif %}
        </div>
    </div>

    <!-- 主要內容插槽（子頁負責放真正的表格 / 圖表 / calendar div） -->
    <main>
        {% block content %}{% endblock %}
    </main>

    <!-- 回到頂部按鈕（共用） -->
    <button id="backToTop" onclick="window.scrollTo({top: 0, behavior: 'smooth'});">回頂部</button>

    <!-- 共用 JS helper -->
    <script>
    // 顯示/隱藏回頂部按鈕
    window.addEventListener('scroll', function() {
        const btn = document.getElementById('backToTop');
        if (!btn) return;
        if (window.scrollY > 300) btn.style.display = 'block';
        else btn.style.display = 'none';
    });

    // 切換區塊（首頁有多個可折疊區塊）
    function toggleSection(id, event) {
        event && event.preventDefault();
        const el = document.getElementById(id);
        if (!el) return;
        el.style.display = (el.style.display === 'none' || el.style.display === '') ? 'block' : 'none';
    }

    // HUB toggle（原地保留，子頁也能覆寫）
    function toggleHUB() {
        const hub = document.getElementById("HUB-content");
        if (!hub) return;
        hub.style.display = (hub.style.display === "none" || hub.style.display === "") ? "block" : "none";
    }
    </script>

    {% block extra_scripts %}{% endblock %}
</body>
</html>
