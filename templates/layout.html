<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>{{ page_title or "門市資料查詢" }}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 40px;
            background-color: #f7f7f7;
        }

        h1 {
            text-align: center;
            color: #333;
        }

        form, .buttons {
            text-align: center;
            margin-bottom: 20px;
        }

        input[type="text"], select {
            padding: 10px;
            width: 160px;
            border-radius: 5px;
            border: 1px solid #ccc;
            margin: 5px;
        }

        /* 讓 <a class="btn"> 表現如按鈕 */
        .btn {
            display: inline-block;
            padding: 10px 15px;
            font-size: 20px;
            margin: 5px;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            cursor: pointer;
            border: none;
            text-align: center;
            background-color: #007BFF;
        }

        .btn-primary { background-color: #007BFF; }
        .btn-teal { background-color: #20B2AA; }
        .btn-orange { background-color: #FFA500; color: white; }
        .btn-black { background-color: #000000; }
        .btn-green { background-color: #28a745; color: white; }

        button {
            padding: 10px 15px;
            font-size: 20px;
            margin: 5px;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button.button-1 {
            padding: 10px 15px;
            font-size: 20px;
            margin: 5px;
            background-color: #20B2AA;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button.button-2 {
            padding: 10px 15px;
            font-size: 20px;
            margin: 5px;
            background-color: #FFA500;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button.button-3 {
            padding: 10px 15px;
            font-size: 20px;
            margin: 5px;
            background-color: #000000;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .button-row {
            display: flex;
            flex-wrap: wrap;
            justify-content: flex-start;
            gap: 10px;
            align-items: center;
        }

        /* nav-group 用來把按鈕分群 */
        .nav-group { display:flex; gap:6px; flex-wrap:wrap; align-items:center; }

        .button a,
        .button-1 a {
            text-decoration: none;
        }

        .table-container {
            overflow-y: auto;
            max-height: 600px;
            border: 1px solid #ccc;
        }

        .table-container-NO {
            overflow-y: visible;
            max-height: none;
            border: 1px solid #ccc;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background-color: white;
            table-layout: fixed;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: center;
            word-wrap: break-word;
        }

        th {
            background-color: #007BFF;
            color: white;
            position: sticky;
            top: 0;
            z-index: 2;
        }

        tr:hover {
            background-color: #f1f1f1;
        }

        .highlight-row td {
            color: red;
            font-weight: bold;
            border-top: 2px solid black;
        }

        .status-pm {
            background-color: red;
            color: white;
            padding: 6px;
            border-radius: 4px;
            display: inline-block;
        }

        .status-replaced {
            color: green;
        }

        .status-not-replaced {
            color: red;
        }

        .status-repair {
            color: black;
            font-weight: bold;
            background-color: #d8ecff;
            padding: 6px;
            border-radius: 4px;
        }

        #backToTop {
            position: fixed;
            bottom: 230px;
            right: 30px;
            z-index: 1000;
            display: none;
            padding: 10px 15px;
            font-size: 16px;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        #backToTop:hover {
            background-color: #0056b3;
        }

        .version-info {
            text-align: center;
            color: gray;
            font-size: 14px;
            margin-top: -25px;
            margin-bottom: 20px;
        }

        /* 特殊欄位背景色標記 */
        .blue-bg {
            background-color: lightblue;
        }

        .orange-bg {
            background-color: orange;
        }

        .green-bg {
            background-color: lightgreen;
        }

        /* DataFrame 表格風格 */
        .dataframe {
            width: 100% !important;
            border-collapse: collapse;
        }

        .dataframe th, .dataframe td {
            border: 1px solid #ccc;
            padding: 10px;
            text-align: center;
            word-break: break-word;
        }

        .dataframe th {
            background-color: #007BFF;
            color: white;
            position: sticky;
            top: 0;
            z-index: 1;
        }

        /* 小容器 */
        .content-wrap {
            max-width: 1200px;
            margin: 0 auto;
        }

        @media (max-width: 800px) {
            body { padding: 18px; }
            input[type="text"], select { width: 100%; max-width: 320px; }
            .content-wrap { padding: 0 8px; }
            .button-row { gap: 8px; justify-content: center; }
            .btn, .button-row button { font-size: 18px; padding: 8px 12px; }
        }
    </style>

</head>
<body>
    <div class="content-wrap">
        <!-- 標題與版號 -->
        <h1>
			{{ page_header or (
				"出勤時間統計" if time_page else
				"報修查詢" if report_page else
				("PMQ4 個人查詢: " ~ personal_page) if personal_page else
				"部門排程" if calendar_page else
				"計費系統" if billing_page else
				"PMQ4 部門總覽"
			) }}
        </h1>

        {% if version %}
        <div class="version-info">版本：{{ version }}</div>
        {% endif %}

        <!-- 搜尋欄位（子頁可透過 template 傳參數控制是否顯示） -->
        <form method="get" style="text-align:center; margin-bottom:16px;">
            {% if not report_page and not calendar_page and not time_page %}
                <input type="text" name="keyword" placeholder="請輸入關鍵字查詢" value="{{ keyword|default('') }}">
            {% endif %}
            {% if report_page %}
                <input type="text" name="store_id" placeholder="門市編號" value="{{ store_id|default('') }}">
                <select name="repair_item">
                    <option value="">-- 選擇報修類別 --</option>
                    {% for item in [
                        'HL-TM主機', 'HL-熱感發票機', 'HL-立式掃描器', 'HL-多卡機QP3000E', 'HL-CCD掃描器(TM)',
                        'HL-CCD掃描器(SC)', 'HL-SC主機', 'HL-SC螢幕', 'HL-HUB', 'HL-雷射印表機', 'HL-4G分享器',
                        'HL-PepLink負載平衡器', 'HL-LIFE-ET主機', 'HL-LIFE-ET熱感機T70II', 'HL-LIFE-ET印票機L90',
                        'LIFE-ET 標籤印表機', 'HL-LIFE-ET QRcode掃描器', 'HL-LIFE-ET IC晶片讀卡機', 'HL-LIFE-ET 標籤印表機'
                    ] %}
                        <option value="{{ item }}" {% if repair_item == item %}selected{% endif %}>{{ item }}</option>
                    {% endfor %}
                </select>
            {% endif %}
            {% if not calendar_page and not time_page %}
                <button type="submit" class="btn btn-primary">搜尋</button>
            {% endif %}
        </form>

        <!-- 導覽按鈕列（語意正確的 a.btn） -->
        <div class="button-row" role="navigation" aria-label="主要功能選單">
            <div class="nav-group">
                <a href="{{ url_for('personal', name='吳宗鴻') }}" class="btn btn-primary">吳宗鴻</a>
                <a href="{{ url_for('personal', name='湯家瑋') }}" class="btn btn-primary">湯家瑋</a>
                <a href="{{ url_for('personal', name='狄澤洋') }}" class="btn btn-primary">狄澤洋</a>
            </div>

            <div class="nav-group" style="margin-left:12px;">
                <a href="{{ url_for('report') }}" class="btn btn-teal">報修查詢</a>
                <a href="https://bot.toshibatec.com.tw/hl0800/showjob31.php" target="_blank" rel="noopener noreferrer" class="btn btn-teal">報修刊版</a>
                <a href="https://imainte.toshibatec.com.tw/i_mainte_center2/login.cfm" target="_blank" rel="noopener noreferrer" class="btn btn-orange">iMainte</a>
                <a href="http://eip.toshibatec.com.tw/Main.aspx" target="_blank" rel="noopener noreferrer" class="btn btn-orange">EIP</a>
                <a href="{{ url_for('time_page') }}" class="btn btn-teal">出勤時間統計</a>
                <a href="{{ url_for('calendar_page') }}" class="btn btn-orange">排程表</a>
                <a href="{{ url_for('mfp_parts') }}" class="btn btn-teal">MFP_零件表</a>
                <a href="{{ url_for('billing.index') }}" class="btn btn-teal">客戶TG系統</a>
                <a href="{{ url_for('home') }}" class="btn btn-green">回首頁</a>
            </div>
        </div>

        <!-- ===== 子頁內容插入點 ===== -->
        <main>
            {% block content %}
            <!-- 子頁會覆寫這塊 -->
            <div class="table-container">
                <p style="text-align:center; color:var(--muted); padding:20px 0;">請在子模板中填入內容。範例：{{ url_for('index') }}</p>
            </div>
            {% endblock %}
        </main>

        <!-- 回頂部按鈕（當需要可顯示） -->
        <button id="backToTop" onclick="window.scrollTo({top:0, behavior:'smooth'});">回頂部</button>
    </div>

    <!-- ===== 全域腳本 ===== -->
    <script>
        // 簡單的回頂與顯示控制（子頁可覆寫或使用 extra_scripts block）
        (function(){
            const btn = document.getElementById('backToTop');
            window.addEventListener('scroll', function(){
                if(window.scrollY > 400){
                    btn.style.display = 'block';
                } else {
                    btn.style.display = 'none';
                }
            });
        })();
    </script>

    <!-- ===== 子頁專屬腳本插入點 ===== -->
    {% block extra_scripts %}
    {% endblock %}
</body>
</html>
